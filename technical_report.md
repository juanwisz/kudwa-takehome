# Technical Report – Kudwa Financial AI System

## 1. Project Overview and Architecture

The project integrates financial data from QuickBooks and RootFi into a single SQLite database and provides an API layer enriched with AI capabilities. Users can query the data in natural language, and the system responds with structured reports generated by an LLM.

### Architecture Components
- **Data Ingestion**: `scripts/load_data.py` parses JSON datasets into the `transactions` table.
- **Database**: SQLite with two core tables (`transactions`, `query_logs`).
- **API Layer**: FastAPI provides endpoints for data access (`/data/raw`), querying (`/query`), and forecasting (`/plot/forecast`).
- **AI Layer**: LangChain + OpenAI GPT model interpret user queries, generate SQL, and return narrative reports.
- **Analytics Layer**: ARIMA forecasting via `statsmodels`.
- **Logging**: All queries persisted in database and written to `logs/queries.log`.

---

## 2. Technology Stack and Rationale

- FastAPI – clean, async-friendly API framework, easy to document and test.  
- SQLite – lightweight, requires no external setup, sufficient for prototype.  
- SQLAlchemy – ORM for database abstraction and maintainability.  
- LangChain + OpenAI – allows natural language to SQL translation and structured reporting.  
- Statsmodels (ARIMA) – classical time-series forecasting for financial trends.  
- Pandas + Matplotlib – for data preparation and visualization.  
- Docker + Render – to provide containerized, deployable solution.

This stack was chosen for clarity, maintainability, and rapid development while showcasing AI integration depth.

---

## 3. Setup and Installation

1. Clone repository:  
   ```bash
   git clone <repo_url>
   cd <repo>
   ```
2. Install dependencies:  
   ```bash
   pip install -r requirements.txt
   ```
3. Configure `.env` with `OPENAI_API_KEY`.  
4. Initialize database and ingest data:  
   ```bash
   make load_data
   ```
5. Run API:  
   ```bash
   make run
   ```
6. Access endpoints via `http://localhost:8000`.

---

## 4. AI/ML Approach and Model Choices

- **Model**: GPT-4 via LangChain integration (`ChatOpenAI`).  
- **Prompt Design**: Injects live database schema, restricts LLM to SQL `SELECT` queries only, instructs output as Markdown financial reports.  
- **Tools**:
  - `sql_query`: executes read-only SQL on transactions.  
  - `forecast_arima`: aggregates time series and runs ARIMA forecast.  
- **Rationale**: GPT-4 chosen for its reliability with structured tasks like SQL translation. LangChain enables safe orchestration and tool calling.

---

## 5. Known Issues and Limitations

1. Forecasting accuracy limited by dataset size and ARIMA assumptions.  
2. Multi-turn conversation not supported; queries are independent.  
3. SQLite not suitable for scale or concurrent writes; PostgreSQL would be used in production.  
4. LLM queries incur latency and cost; caching and model alternatives could mitigate this.  
